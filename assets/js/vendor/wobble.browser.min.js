var Wobble=function(t){"use strict";var i=Object.assign||function(t){for(var i,e=1,n=arguments.length;e<n;e++){i=arguments[e];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t};function e(t,i){if(!t)throw new Error(i)}function n(t,i){return void 0!==t&&null!==t?t:i}var r=function(){function t(t){void 0===t&&(t={}),this._listeners=[],this._currentAnimationStep=0,this._currentTime=0,this._springTime=0,this._currentValue=0,this._currentVelocity=0,this._isAnimating=!1,this._oscillationVelocityPairs=[],this._config={fromValue:n(t.fromValue,0),toValue:n(t.toValue,1),stiffness:n(t.stiffness,100),damping:n(t.damping,10),mass:n(t.mass,1),initialVelocity:n(t.initialVelocity,0),overshootClamping:n(t.overshootClamping,!1),allowsOverdamping:n(t.allowsOverdamping,!1),restVelocityThreshold:n(t.restVelocityThreshold,.001),restDisplacementThreshold:n(t.restDisplacementThreshold,.001)},this._currentValue=this._config.fromValue,this._currentVelocity=this._config.initialVelocity}return t.prototype.start=function(){var t=this,i=this._config,e=i.fromValue,n=i.toValue,r=i.initialVelocity;return e===n&&0===r||(this._reset(),this._isAnimating=!0,this._currentAnimationStep||(this._notifyListeners("onStart"),this._currentAnimationStep=requestAnimationFrame(function(i){t._step(Date.now())}))),this},t.prototype.stop=function(){return this._isAnimating?(this._isAnimating=!1,this._notifyListeners("onStop"),this._currentAnimationStep&&(cancelAnimationFrame(this._currentAnimationStep),this._currentAnimationStep=0),this):this},Object.defineProperty(t.prototype,"currentValue",{get:function(){return this._currentValue},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentVelocity",{get:function(){return this._currentVelocity},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isAtRest",{get:function(){return this._isSpringAtRest()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isAnimating",{get:function(){return this._isAnimating},enumerable:!0,configurable:!0}),t.prototype.updateConfig=function(t){this._advanceSpringToTime(Date.now());var e={fromValue:this._currentValue,initialVelocity:this._currentVelocity};return this._config=i({},this._config,e,t),this._reset(),this},t.prototype.onStart=function(t){return this._listeners.push({onStart:t}),this},t.prototype.onUpdate=function(t){return this._listeners.push({onUpdate:t}),this},t.prototype.onStop=function(t){return this._listeners.push({onStop:t}),this},t.prototype.removeListener=function(t){return this._listeners=this._listeners.reduce(function(i,e){return-1!==Object.values(e).indexOf(t)||i.push(e),i},[]),this},t.prototype.removeAllListeners=function(){return this._listeners=[],this},t.prototype._reset=function(){this._currentTime=Date.now(),this._springTime=0,this._currentValue=this._config.fromValue,this._currentVelocity=this._config.initialVelocity},t.prototype._notifyListeners=function(t){var i=this;this._listeners.forEach(function(e){var n=e[t];"function"==typeof n&&n(i)})},t.prototype._step=function(t){var i=this;this._advanceSpringToTime(t,!0),this._isAnimating&&(this._currentAnimationStep=requestAnimationFrame(function(t){return i._step(Date.now())}))},t.prototype._advanceSpringToTime=function(i,n){if(void 0===n&&(n=!1),this._isAnimating){var r=i-this._currentTime;r>t.MAX_DELTA_TIME_MS&&(r=t.MAX_DELTA_TIME_MS),this._springTime+=r;var s=this._config.damping,o=this._config.mass,a=this._config.stiffness,h=this._config.fromValue,u=this._config.toValue,c=-this._config.initialVelocity;e(o>0,"Mass value must be greater than 0"),e(a>0,"Stiffness value must be greater than 0"),e(s>0,"Damping value must be greater than 0");var l=s/(2*Math.sqrt(a*o)),p=Math.sqrt(a/o)/1e3,_=p*Math.sqrt(1-l*l),f=p*Math.sqrt(l*l-1),m=u-h;l>1&&!this._config.allowsOverdamping&&(l=1);var g=0,y=0,V=this._springTime;if(l<1)g=u-(v=Math.exp(-l*p*V))*((c+l*p*m)/_*Math.sin(_*V)+m*Math.cos(_*V)),y=l*p*v*(Math.sin(_*V)*(c+l*p*m)/_+m*Math.cos(_*V))-v*(Math.cos(_*V)*(c+l*p*m)-_*m*Math.sin(_*V));else if(1===l){g=u-(v=Math.exp(-p*V))*(m+(c+p*m)*V),y=v*(c*(V*p-1)+V*m*(p*p))}else{var v;g=u-(v=Math.exp(-l*p*V))*((c+l*p*m)*Math.sinh(f*V)+f*m*Math.cosh(f*V))/f,y=v*l*p*(Math.sinh(f*V)*(c+l*p*m)+m*f*Math.cosh(f*V))/f-v*(f*Math.cosh(f*V)*(c+l*p*m)+f*f*m*Math.sinh(f*V))/f}if(this._currentTime=i,this._currentValue=g,this._currentVelocity=y,n&&(this._notifyListeners("onUpdate"),this._isAnimating))return this._isSpringOvershooting()||this._isSpringAtRest()?(0!==a&&(this._currentValue=u,this._currentVelocity=0,this._notifyListeners("onUpdate")),void this.stop()):void 0}},t.prototype._isSpringOvershooting=function(){var t=this._config,i=t.stiffness,e=t.fromValue,n=t.toValue,r=!1;return t.overshootClamping&&0!==i&&(r=e<n?this._currentValue>n:this._currentValue<n),r},t.prototype._isSpringAtRest=function(){var t=this._config,i=t.stiffness,e=t.toValue,n=t.restDisplacementThreshold,r=t.restVelocityThreshold,s=Math.abs(this._currentVelocity)<=r;return 0!==i&&Math.abs(e-this._currentValue)<=n&&s},t.MAX_DELTA_TIME_MS=1/60*1e3*4,t}();return t.Spring=r,t}({});
